var app=angular.module("PantryApp",["ngCookies","ngRoute","mainController","accountsController","loginController","listsController","listItemsController","foodsController","ngMaterial"]);app.config(["$routeProvider","$mdThemingProvider",function(a,b){a.when("/signup",{templateUrl:"/views/partials/signup.html",controller:"LoginController"}).when("/lists",{templateUrl:"/views/partials/lists.html",controller:"ListsController"}).when("/lists/new",{templateUrl:"/views/partials/new_list.html",controller:"ListsController"}).when("/lists/:id",{templateUrl:"/views/partials/list.html",controller:"ListItemsController"}).when("/inventory/:id",{templateUrl:"/views/partials/inventory.html",controller:"ListItemsController"}).when("/team",{templateUrl:"/views/partials/team.html",controller:"ListItemsController"}).when("/join-team",{templateUrl:"/views/partials/signup.html",controller:"LoginController"}).when("/settings",{templateUrl:"/views/partials/settings.html",controller:"AccountsController"}).otherwise({redirectTo:"/signup"}),b.theme("default").primaryPalette("red").accentPalette("light-green")}]);var accountsCtrl=angular.module("accountsController",["accountService"]);accountsCtrl.controller("AccountsController",["$rootScope","$scope","$location","Account",function(a,b,c,d){b.createTeam=function(){a.user.team_id||d.createTeam(b.newTeam).then(function(){c.path("/team")})},b.invite=function(){b.url="http://localhost:8080/join-team?token="+a.user.team_id},b.removeAccount=function(){a.user.id,a.user.team_id;d["delete"](a.user.id).then(function(b){console.log(b),a.setUser(null),c.path("login")})}}]);var foodCtrl=angular.module("foodsController",["ListItemsFactory"]);foodCtrl.controller("FoodsController",["$scope","$mdDialog","ListItem","listItem","data",function(a,b,c,d,e){console.log("li:",d),a.listItem=d,a.data=e,a.heading="It's working!",a.saveFood=function(){console.log(a.nbd_no),c.edit(a.listItem).then(function(a){console.log("Move along... here's your response:",a),b.hide()})},a.closeModal=function(){b.hide()}}]);var liCtrl=angular.module("listItemsController",["ListItemsFactory","listsFactory"]);liCtrl.controller("ListItemsController",["$rootScope","$scope","$routeParams","$mdMedia","$mdDialog","ListItem","List",function(a,b,c,d,e,f,g){a.user||$location.path("/signup"),f.getList(c.id).then(function(a){b.list=a.data}),b.addListItem=function(){f.create(b.list,b.newListItem).then(function(a){b.list.items.push(a.data),b.newListItem={}})},b["delete"]=function(a,c){f["delete"](a).then(function(a){console.log(a.data),b.list.items.splice(c,1)})},b.findFood=function(a,b){var c;if(b.ndb_no)f.nutrition(b.ndb_no).then(function(f){c=d("sm")||d("xs"),e.show({controller:"FoodsController",templateUrl:"/views/partials/nutrients.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,fullscreen:c,locals:{listItem:b,data:f.data}})});else{f.findFood(b.name).then(function(f){c=d("sm")||d("xs"),e.show({controller:"FoodsController",templateUrl:"/views/partials/food-select.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,fullscreen:c,locals:{listItem:b,data:f.data}})})}},b.totalNutrition=function(){console.log("Calling..."),console.log(b.list),f.nutrition(b.list.items).then(function(a){console.log(a.data)})},b.movingItems=function(){b.moving=!b.moving,b.moving&&(b.userLists=a.user.lists)},b.moveToInventory=function(){b.switchList(a.user.inventory_id)},b.switchList=function(a){console.log(a),a?(console.log("moving..."),f.switchList(a,b.list.items).then(function(a){console.log(a),b.movingItems()})):console.log("Delete")}}]);var listCtrl=angular.module("listsController",["listsFactory"]);listCtrl.controller("ListsController",["$rootScope","$scope","$http","$location","List",function(a,b,c,d,e){a.user||d.path("/signup"),b.lists=a.user.lists,b.addList=function(){b.newList.account_id=b.newList.account_id||a.user.id,e.add(b.newList).then(function(a){b.newList={},b.lists.push(a.data.list),d.path("/lists")})},b.getList=function(a){e.getList(a).then(function(a){b.list=a.data.list,b.list.items=b.list.items||[]})},b.clickList=function(a){"inventory"===a.type?d.path("/inventory/"+a.id):d.path("/lists/"+a.id)},b.deleteList=function(a){e.deleteList(a).then(function(a){console.log(a)})},b.addListItem=function(){e.addListItem().then(function(a){b.list.items.push(a.data.item)})},b.deleteListItem=function(a){e.deleteListItem(a).then(function(a){console.log(a)})}}]);var ctrl=angular.module("loginController",["authService"]);ctrl.controller("LoginController",["$rootScope","$scope","$cookies","$location","Auth","$mdMedia","$mdDialog",function(a,b,c,d,e,f,g){a.user&&d.path("/lists"),b.credentials={},b.loginModal=function(a){var b=(f("sm")||f("xs"))&&!0;g.show({controller:"LoginController",templateUrl:"/views/partials/login.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,fullscreen:b})},b.login=function(){console.log("Logging in with:",b.credentials," to: ",a.user),e.login(b.credentials).then(function(e){if(b.credentials={},e.data.user){var f=e.data.user;console.log("putting cookies"),c.put("pantry_app_t",f.token),a.setUser(f),d.path("/lists"),g.hide()}})}}]);var ctrl=angular.module("mainController",["accountService"]);ctrl.controller("MainController",["$rootScope","$scope","$location","$cookies","Account",function(a,b,c,d,e){a.user=null,a.title="Pantry App",e.getByToken(d.get("pantry_app_t")).then(function(b){a.user=b.data,console.log(a.user)}),a.setUser=function(b){a.user=b},a.logout=function(){d.remove("pantry_app_t"),a.setUser(null),c.path("/login")},a.header="Well, howdy there..."}]);var accountService=angular.module("accountService",[]);accountService.factory("Account",["$http",function(a){var b={};return b.getByToken=function(b){return a.get("/token/"+b)},b.createTeam=function(b){return a.post("/accounts/team",{newTeam:b})},b["delete"]=function(b){return a["delete"]("/accounts/"+b)},b.teammates=function(b){return a.get("/accounts/teammates/"+b)},b}]);var authService=angular.module("authService",["ngCookies"]);authService.factory("Auth",["$http","$cookies",function(a,b){var c={};return c.login=function(b){return a.post("/login",{user:b})},c}]);var liFactory=angular.module("ListItemsFactory",[]);liFactory.factory("ListItem",["$http",function(a){var b={};return b.create=function(b,c){return a.post("/lists/items",{list:b,listItem:c})},b.getList=function(b){return a.get("/lists/"+b)},b.findFood=function(b){return b=b.split(" ").join("+"),a.get("/lists/items/find?name="+b)},b.nutrition=function(b){return"string"!=typeof b?a.post("/lists/items/nutrition",{ndb_no:b}):a.get("/lists/items/nutrition?ndb_no="+b)},b.edit=function(b){return a.patch("/lists/items",{item:b})},b.switchList=function(b,c){return a.patch("/lists/items/move-all",{targetList:b,itemsArr:c})},b["delete"]=function(b){return a["delete"]("/lists/items/"+b)},b}]);var listModel=angular.module("listsFactory",[]);listModel.factory("List",["$http",function(a){var b={};return b.add=function(b){return a.post("/lists",{list:b})},b.getList=function(b){return b=b||"",a.get("/lists/"+b)},b.deleteList=function(b){return a["delete"]("/lists/"+b)},b.addListItem=function(b,c){return a.post("/lists/items",{list:b,listItem:c})},b.deleteListItem=function(b){return a["delete"]("/lists/items/"+b)},b}]);